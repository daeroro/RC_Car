<3.2> PRCM 서브시스템 개요

<3.2.1> 소개

the power-management framework of the device (PMFW)
->동적인 파워 소비와 정적인 전류 낭비를 줄인다.

세가지의 물리적 서브모듈로 구성
1. PRM: 디바이스 레벨 파와와 리셋을 관리
2. CM_CORE_AON: 디바이스 레벨의 클락을 관리
3. CM_CORE: 디바이스 레벨의 클락을 관리

다음과 같은 특징이 있다.
* 볼티지, 파워, 클락, 리셋 도메인으로 나눠져 있다.
* ON/OFF상태의 어떤 조합도 가능한 독립적인 도메인
* 클락이 닫히는 선택적인 조건을 가진 클락 트리
* 하드웨어로 컨트롤하는 리셋 과정 관리
* 파워 도메인의 자고 깨는 디펜던시(의존)를 관리할 수 있는 파워, 리셋, 클락 컨트롤 하드웨어 메커니즘
* 하드웨어로 컨트롤하는 모듈 클락의 자동닫힘을 지원
* 저전력 자는 모드에서 메모리 내용을 보존할 수 있는 메모리 능력
* 프로세서와 주변기기에 DVFS(전력을 줄이는 방법 중 하나) 지원

(아마도 PMFW의) 획기적인 하드웨어 구조는 낭비되는 전류를 상당히 줄이게 해준다.


<3.2.2> Power-Management Framework Features (PMFW)

파워 관리 모듈:
* 독립적인 파워 도메인 관리
* 스케일 조절 가능한 로직 볼티지 도메인과 메모리 볼티지 도메인의 선택가능한 전압 모드를 컨트롤
* 장치 모듈의 스탠바이, 잠드는, 일어나는 과정을 다룬다.
* 소프트웨어와 부분적인 하드웨어 컨트롤을 허용
* 모디터를 하고 일어나는 이벤트를 다룬다.
* 시스템 클락을 컨트롤하고 입력 소스를 리셋한다.
* 클락과 리셋을 높은 컨트롤 granularity(정밀도)를 가지고 관리
* 파워를 올리는 과정을 다룬다.
* 디버깅과 시범 실행
* DPS를 지원하기 위한 장치 모듈의 RFF를 컨트롤


<3.3> PRCM 서브시스템 환경

PMFW의 모듈은 외부의 리셋, 클락, 파워 신호를 받는다.
다음은 외부신호들을 위한 인터페이스를 기술하였다.


바깥의 신호들은 데이터시트의 표를 참고
<3.3.1> 바깥의 클락 신호

<3.3.2> 바깥의 부팅 신호

<3.3.3> 바깥의 리셋 신호

PRM은 SYS_WARM_OUT_RST 출력을 내보낸다.
이 리셋 신호는 바깥의 주변장치가 리셋상태로 유지하게 한다. 디바이스가 리셋 상태에 있는 동안

<3.3.4> 바깥의 볼티지 입력


<3.4> PRCM 서브시스템의 통합

파워 관리 모듈의 안쪽 구성 레지스터는 구성과 컨트롤을 위해 그들 각각의 L4_WKUP 인터커넥트를 통해 접근가능하다.
L4 인터커넥트를 하면 안쪽 모듈의 인터페이스는 다음과 같은 인터페이스와 시그널을 갖는다.

* 각 모듈의 잠자는 신호와 일어나는 컨트롤 세트  
* 모듈의 클락과 리셋 신호
* 파워 도메인의 파워 컨트롤 신호(스위치와 메모리)
* MPU, IPU, DSP INTCs의 인터럽트
* PLL(Phase-locked loop) 컨트롤은 리켈리브레인션과 DPLL(digital phase-locked)의 바이패스를 명령한다.


<3.4.1> 장치 파워 관리 레이아웃

PMRW는 클락, 파워, 볼티지 도메인으로 장치를 나눈다.

표 3-27은 디바이스 레벨의 모듈을 클락, 파워, 볼티지 도메인 조합으로 보여준다.

<3.4.2> 파워 매니지먼트 계획, 리셋, 인터럽트 요청

<3.4.2.1> 파워 도메인

표 3-28 참고

PRM: 계속 활성화 되어 있다. 파워도메인의 상태 변화를 관리하고 일어나는 신호를 감지하기 위한 로직으로 이루어져 있다.
CM_CORE_AON: 항상 활성화 되어 있다.
CM_CORE: 반면에 이 모듈은 어플리케이션을 사용하는데 필요하면 활성화가 되거나 되지 않는다.


<3.4.2.2> 리셋

표 3-29 참고


<3.4.2.3> PRCM 인터럽트 요청

표 3-30 참고

-----------------------------------------------------------------------------------------------------
<3.5> 리셋 매니지먼트의 기능적인 묘사

<3.5.1> 개요

디바이스 안에서 리셋의 계획은 디바이스 레벨의 리셋 매니저인 PRM에 의해 관리된다.


<3.5.1.1> PRCM 리셋 매니지먼트의 기능적인 묘사 

PRM은 디바이스의 파워를 켜고 리셋 패드(porz, resetn, and rstoutn)를 데운다.

PRM이 하는 일
* porz패드가 늘인 것 이상으로 리셋 duration을 확장한다.
* resetn 패드가 시작된 후 리셋 duration 주기를 제공한다.
* 장치 패드를 리셋시킨다.


<3.5.1.1.1> 파워 온 리셋

PRM은 장치의 porz 리셋 패드에 있는 POR 장치를 받는다.(가지고 있다?)
POR의 duration을 안정된 32-kHZ와 SYS_CLK1이 주어질 때까지 확장힌다.
PRCM이 내부의 POR을 작동할 때(release) 32-kHZ와 SYS_CLK1이 전파된다.


<3.5.1.1.2> 웜 리셋

장치 웜 리셋은 내부의 이벤트 결과로 바깥의 소스나 PRM모듈로부터 주어진다.
PRCM은 다음의 웜 리셋 입력 소스로부터 도메인 리셋 매니저에 의해 만들어지는 글로벌 리셋을 발생시킨다.

웜 리셋 입력 소스:
* SYS_WARM-IN_RST
* MPU_WDT_RST
* GLOBAL_SW_WARM_RST


<3.5.1.2> PRM 매니지먼트의 기능적인 묘사

모든 PRM 리셋 출력은 비동기적으로 시작한다. SYS_CLK1 클락이 동기적으로 끝나는데(deassertion) 비해
PRM의 리셋 매니저는 이 클락을 소스 비활성화에 의한 리셋 끝마침을 망보거나(stall, 모니터한다?) 늦추는데 사용한다.

모든 연결된 리셋 도메인의 모듈들은 리셋 신호가 시작되면 동시에 리셋된다.
리셋 도메인들의 독립적인 컨트롤은 리셋이 시작되는 것을 차례로 하게 하고 전체의 파워 도메인의 안전한 리셋을 보장한다.


<3.5.2> 리셋 신호의 일반적인 분류

* Scope(범위): 글로벌 리셋, 로컬 리셋
* Occurrence(발생): 차가운 리셋, 따뜻한 리셋
* Source type(소스 종류): 소프트웨어 리셋, 하드웨어 리셋
* Retention type(리텐션 타입): 리텐션 리셋, 논리텐션 리셋


<3.5.2.1> Scope(범위)

글로벌 리셋: 장치의 전체 로직에 영향을 준다. 모든 모듈이 리셋
지역 리셋: 하나의 파워 도메인이나 리셋 도메인이나 모듈에 영향


<3.5.2.2> Occurrence(발생)

차가운 리셋: 디바이스가 켜지는 중에 발생했을 가능성이 높다. 그래서 장치 안의 모든 것을 리셋한다.
따뜻한 리셋: 모듈 로직의 subset을 리셋하기 위해 사용
	    이것은 차가운 리셋보다 리셋에서 회복되는 속도가 빠르다.

RST와 PWRON_RST, 두가지 리턴 신호로 두가지를 구분해 사용한다.


<3.5.2.3> Source type(소스 종류)

소프트웨어 리셋: PRCM 모듈의 레지스터로 발생
하드웨어 리셋: PRCM 모듈의 안쪽이나 바깥쪽에 있는 하드웨어로 발생


<3.5.2.4> Retention type(리텐션 타입)

지역의 차가운 리셋의 두가지 타입, 리텐션 리셋과 논리텐션 리셋

파워도메인이 꺼졌던 상태에서 활성화 상태로 갈 때
* 리텐션 리셋과 논리텐션 리셋이 항상 시작된다.

파워도메인이 리턴션 상태에서 활성화 상태로 갈 때
* 리텐션 리셋을 절대 시작되지 않는다.
* 논리텐션 리셋은 경우에 따라 시작된다.
-> 파워도메인이 CSWR_리텐션 상태에서 변화했을 때 시작되지 않는다.


<3.5.3> 리셋 소스

PRM안에 있는 리셋 매니저를 시작하게 하는 것이 리셋 소스


<3.5.3.1> 글로벌 리셋 소스

표 3-31 참고 (하드웨어 리셋과 소프트웨어 리셋으로 나눠진다.)


<3.5.3.2> 지역 리셋 소스

지역 리셋 소스는 차가운 리셋과 따뜻한 리셋의 소스도 된다.

표 3-32 참고


<3.5.4> 리셋 로깅(적어놓는 거?)

리셋 상태 비트는 리셋이 도메인에서 실행될 때 항상 기록된다.

글로벌 차가운 리셋이 시작된 후 리셋 상태 레지스터는 0으로 지워진다. 
도메인이 리셋이 되고 있을 떄, 글로벌 차가운 리셋을 기록하는 레지스터 비트가 1로 업데이트 된다.

이런 상황에서 유효하다.
* 도메인의 리셋 신호가 발생하기 전이고 글로벌 차가운 리셋의 활동 주기 전, 후 혹은 그 동안, 글로벌 차가운 리셋 이외 리셋의 소스가가 시작될 때
* 글로벌 차가운 리셋이외 리셋 소스가 시작되고 진행되는데 글로벌 차가운 리셋 소스가 도메인 리셋 신호가 발생하기 전에 시작될 때


<3.5.5> 리셋 도메인

파워 도메인은 파워 온 리셋(PWRON_RST) 신호, 노멀 리셋(PST) 신호를 받을 수 있다. (둘 다 혹은 둘 중 하나만)

* 글로벌 리셋 or 지역의 차가운 리셋: 두 신호 모두 시작
* 글로벌 리셋 or 지역의 따뜻한 리셋: 오직 PST만 시작
* 꺼진 상태에서 깨어나는 경우: PWRON_RST가 시작


파워 도메인은 두 가지의 추가적인 리텐션 로직 리셋 신호를 받을 수 있다.
파워 온 리텐션 리셋(PWRON_RET_RST) 신호, 리텐션 리셋(RET_RST) 신호 (둘 다 혹은 둘 중 하나만)

* 글로벌 차가운 리셋: 두 신호 모두 시작
* 글로벌 차가운 리셋 or 꺼진 상태에서 활성화 상태로 깨어나는 경우: 두 신호 모두 시작
* 글로벌 따뜻한 리셋: 오직 RET_RST만 시작
